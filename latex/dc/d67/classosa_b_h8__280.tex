\hypertarget{classosa_b_h8__280}{}\section{osa\+B\+H8\+\_\+280 Class Reference}
\label{classosa_b_h8__280}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}


A clas for a B\+H8\+\_\+280 device.  




{\ttfamily \#include $<$osa\+B\+H8\+\_\+280.\+h$>$}

\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541}{Errno} \{ \hyperlink{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541a289fed3893b602379925476347abcd4d}{E\+S\+U\+C\+C\+E\+S\+S}, 
\hyperlink{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541a57eddce6577f269dfaa16b115952b6b6}{E\+F\+A\+I\+L\+U\+R\+E}
 \}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classosa_b_h8__280_a13a1d864a85c317b8a0ab2c39b9cc515}{osa\+B\+H8\+\_\+280} (\hyperlink{classosa_c_a_n_bus}{osa\+C\+A\+N\+Bus} $\ast$canbus)
\begin{DoxyCompactList}\small\item\em Default constructor. \end{DoxyCompactList}\item 
\hyperlink{classosa_b_h8__280_ad48ec97fc8bdb4b2c0ce91b5569ce55a}{$\sim$osa\+B\+H8\+\_\+280} ()
\begin{DoxyCompactList}\small\item\em Default destructor. \end{DoxyCompactList}\item 
\hyperlink{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541}{osa\+B\+H8\+\_\+280\+::\+Errno} \hyperlink{classosa_b_h8__280_aad206fdab519475fea24f9335861c447}{Initialize} ()
\begin{DoxyCompactList}\small\item\em Initialize the arm. \end{DoxyCompactList}\item 
\hyperlink{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541}{osa\+B\+H8\+\_\+280\+::\+Errno} \hyperlink{classosa_b_h8__280_a13b0d3632aa4f1868060ed65e31c1fbc}{Get\+Positions} (\hyperlink{classvct_dynamic_vector}{vct\+Dynamic\+Vector}$<$ double $>$ \&positions)
\begin{DoxyCompactList}\small\item\em Return the configuration of the B\+H8\+\_\+280 (4/7\+D\+O\+F) \end{DoxyCompactList}\item 
\hyperlink{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541}{osa\+B\+H8\+\_\+280\+::\+Errno} \hyperlink{classosa_b_h8__280_a970f68ef50c92a9634f3a9ed89e64144}{Set\+Positions} (const \hyperlink{classvct_dynamic_vector}{vct\+Dynamic\+Vector}$<$ double $>$ \&positions)
\begin{DoxyCompactList}\small\item\em Send joints positions. \end{DoxyCompactList}\item 
\hyperlink{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541}{osa\+B\+H8\+\_\+280\+::\+Errno} \hyperlink{classosa_b_h8__280_a567fdc2413e6066147e25135687f6fcb}{Set\+Mode} (\hyperlink{struct_barrett_a57ff132885344ca62e4b4b691885685b}{Barrett\+::\+Value} mode)
\begin{DoxyCompactList}\small\item\em Set joints torques. \end{DoxyCompactList}\item 
void \hyperlink{classosa_b_h8__280_a1a5810b25b84091828e36ee9eb14228f}{Hi} ()
\end{DoxyCompactItemize}


\subsection{Detailed Description}
A clas for a B\+H8\+\_\+280 device. 

Whole Arm Manipulator (B\+H8\+\_\+280) is a 4-\/7\+D\+O\+F robot manufactured by \hyperlink{struct_barrett}{Barrett} Tech. From a device perspective the B\+H8\+\_\+280 can be interfaced from either an ethernet device (wired or wireless) or a C\+A\+N device. On the B\+H8\+\_\+280, the ethernet device is connected to a P\+C104. Thus, when using ethernet you can communicate with the onboard computer through a shell or client/server. The downside of this is that the P\+C104 does all the (C\+A\+N) communication with the motors and much of the computation as well. The P\+C104 can be bypassed and the motor can be controlled by an external P\+C (see the documentation on how to configure the switches). For this, the external P\+C must have a C\+A\+N device and the communication with the hardware must be established and maintained. The \hyperlink{classosa_b_h8__280}{osa\+B\+H8\+\_\+280} class implements a B\+H8\+\_\+280 that can be controlled from an external P\+C. Thus it manages the C\+A\+N bus, the pucks present on the C\+A\+N bus and the B\+H8\+\_\+280\textquotesingle{}s safety module. Operations are pretty basic\+: set motors torques, set motor positions and get motor positions. 

\subsection{Member Enumeration Documentation}
\hypertarget{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!Errno@{Errno}}
\index{Errno@{Errno}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{Errno}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf osa\+B\+H8\+\_\+280\+::\+Errno}}\label{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{E\+S\+U\+C\+C\+E\+S\+S@{E\+S\+U\+C\+C\+E\+S\+S}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!E\+S\+U\+C\+C\+E\+S\+S@{E\+S\+U\+C\+C\+E\+S\+S}}\item[{\em 
\hypertarget{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541a289fed3893b602379925476347abcd4d}{}E\+S\+U\+C\+C\+E\+S\+S\label{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541a289fed3893b602379925476347abcd4d}
}]\index{E\+F\+A\+I\+L\+U\+R\+E@{E\+F\+A\+I\+L\+U\+R\+E}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!E\+F\+A\+I\+L\+U\+R\+E@{E\+F\+A\+I\+L\+U\+R\+E}}\item[{\em 
\hypertarget{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541a57eddce6577f269dfaa16b115952b6b6}{}E\+F\+A\+I\+L\+U\+R\+E\label{classosa_b_h8__280_ab8ba653b44589ea6165d12717ff97541a57eddce6577f269dfaa16b115952b6b6}
}]\end{description}
\end{Desc}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classosa_b_h8__280_a13a1d864a85c317b8a0ab2c39b9cc515}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{osa\+B\+H8\+\_\+280}]{\setlength{\rightskip}{0pt plus 5cm}osa\+B\+H8\+\_\+280\+::osa\+B\+H8\+\_\+280 (
\begin{DoxyParamCaption}
\item[{{\bf osa\+C\+A\+N\+Bus} $\ast$}]{canbus}
\end{DoxyParamCaption}
)}\label{classosa_b_h8__280_a13a1d864a85c317b8a0ab2c39b9cc515}


Default constructor. 

Initiallize the B\+H8\+\_\+280. This configures the pucks, groups and the safety module. You can use \hyperlink{classosa_b_h8__280}{osa\+B\+H8\+\_\+280} with any C\+A\+N device, has long as it is derived from the dev\+C\+A\+N base class. 
\begin{DoxyParams}{Parameters}
{\em canbus} & The C\+A\+N device used by the B\+H8\+\_\+280. This device must be derived from the dev\+C\+A\+N classe. \\
\hline
\end{DoxyParams}
\begin{DoxySeeAlso}{See also}
\hyperlink{classosa_c_a_n_bus}{osa\+C\+A\+N\+Bus} 
\end{DoxySeeAlso}
\hypertarget{classosa_b_h8__280_ad48ec97fc8bdb4b2c0ce91b5569ce55a}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!````~osa\+B\+H8\+\_\+280@{$\sim$osa\+B\+H8\+\_\+280}}
\index{````~osa\+B\+H8\+\_\+280@{$\sim$osa\+B\+H8\+\_\+280}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{$\sim$osa\+B\+H8\+\_\+280}]{\setlength{\rightskip}{0pt plus 5cm}osa\+B\+H8\+\_\+280\+::$\sim$osa\+B\+H8\+\_\+280 (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classosa_b_h8__280_ad48ec97fc8bdb4b2c0ce91b5569ce55a}


Default destructor. 



\subsection{Member Function Documentation}
\hypertarget{classosa_b_h8__280_a13b0d3632aa4f1868060ed65e31c1fbc}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!Get\+Positions@{Get\+Positions}}
\index{Get\+Positions@{Get\+Positions}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{Get\+Positions}]{\setlength{\rightskip}{0pt plus 5cm}{\bf osa\+B\+H8\+\_\+280\+::\+Errno} osa\+B\+H8\+\_\+280\+::\+Get\+Positions (
\begin{DoxyParamCaption}
\item[{{\bf vct\+Dynamic\+Vector}$<$ double $>$ \&}]{positions}
\end{DoxyParamCaption}
)}\label{classosa_b_h8__280_a13b0d3632aa4f1868060ed65e31c1fbc}


Return the configuration of the B\+H8\+\_\+280 (4/7\+D\+O\+F) 

Get joints positions This broadcast a position query to the pucks and process all their replies. First, the replies (in encoder ticks) are converted to motors positions and then to joint angles. 
\begin{DoxyParams}{Parameters}
{\em positions\mbox{[}out\mbox{]}} & The resulting motor positions in radians \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
E\+S\+U\+C\+C\+E\+S\+S if no error occurred. E\+F\+A\+I\+L\+U\+R\+E otherwise. 
\end{DoxyReturn}
\hypertarget{classosa_b_h8__280_a1a5810b25b84091828e36ee9eb14228f}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!Hi@{Hi}}
\index{Hi@{Hi}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{Hi}]{\setlength{\rightskip}{0pt plus 5cm}void osa\+B\+H8\+\_\+280\+::\+Hi (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classosa_b_h8__280_a1a5810b25b84091828e36ee9eb14228f}
\hypertarget{classosa_b_h8__280_aad206fdab519475fea24f9335861c447}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{Initialize}]{\setlength{\rightskip}{0pt plus 5cm}{\bf osa\+B\+H8\+\_\+280\+::\+Errno} osa\+B\+H8\+\_\+280\+::\+Initialize (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{classosa_b_h8__280_aad206fdab519475fea24f9335861c447}


Initialize the arm. 

Configure the groups and the pucks \hypertarget{classosa_b_h8__280_a567fdc2413e6066147e25135687f6fcb}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!Set\+Mode@{Set\+Mode}}
\index{Set\+Mode@{Set\+Mode}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{Set\+Mode}]{\setlength{\rightskip}{0pt plus 5cm}{\bf osa\+B\+H8\+\_\+280\+::\+Errno} osa\+B\+H8\+\_\+280\+::\+Set\+Mode (
\begin{DoxyParamCaption}
\item[{{\bf Barrett\+::\+Value}}]{mode}
\end{DoxyParamCaption}
)}\label{classosa_b_h8__280_a567fdc2413e6066147e25135687f6fcb}


Set joints torques. 

Set the torques of each joint. First this converts the joints torques to motors torques. Then it packs the torques in two C\+A\+N frames. The first frame is addressed the upper arm group and the second frame is addressed to the forearm group (if present). 
\begin{DoxyParams}{Parameters}
{\em torques\mbox{[}in\mbox{]}} & The motor torques \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
E\+S\+U\+C\+C\+E\+S\+S if no error occurred. E\+F\+A\+I\+L\+U\+R\+E otherwise\+Set velocity warning The safety module intercepts joints positions and compute joints velocities from them. After \char`\"{}zeroing\char`\"{} the joints (setting their initial values), the safety module compute the Cartesian velocity of the elbow and the Cartesian velocity of the 4\+D\+O\+F end-\/effector. If any of these velocities is greater than the velocity warning limit, the safety module will display a warning on the 7-\/segment of the display pendant (\char`\"{}\+E\char`\"{} for elbow and \char`\"{}\+A\char`\"{} for arm) and the \char`\"{}\+Warning Velocity\char`\"{} L\+E\+D will be on. The warning won\textquotesingle{}t affect anything other than warn you to slow down before a velocity fault shuts down the arm.\+Set velocity fault The safety module intercepts joints positions and compute joints velocities from them. After \char`\"{}zeroing\char`\"{} the joints (setting their initial values), the safety module compute the Cartesian velocity of the elbos and the Cartesian velocity of the 4\+D\+O\+F end-\/effector. If any of these velocities is greater than the velocity fault threshold, the safety module will shutdown the arm and display the fault on the 7-\/segment of the display pendant (\char`\"{}\+E\char`\"{} for elbow and \char`\"{}\+A\char`\"{} for arm) and the \char`\"{}\+Velocity Fault\char`\"{} L\+E\+D will be on. Set torque warning The safety module intercepts joints currents that are sent to the pucks. If any of these torques is greater than the torque warning limit, the safety module will display a warning on the 7-\/segment of the display pendant (the number of the joint with too much torque) and the \char`\"{}\+Warning 
\+Torque\char`\"{} L\+E\+D will be on. The warning won\textquotesingle{}t affect anything other than warn you to ease down the torque before a torque fault shuts down the arm. Keep in mind that this torque limit is \char`\"{}one size fits all\char`\"{}. That is the torque warning limit of motor 1 will apply to motor 7 and vice versa.\+Set torque fault The safety module intercepts joints currents that are sent to the pucks. If any of these torques is greater than the torque fault limit, the safety module will shutdown the arm and display a warning on the 7-\/segment of the display pendant (the number of the joint with too much torque) and the \char`\"{}\+Fault Torque\char`\"{} L\+E\+D will be on. Keep in mind that this torque limit is \char`\"{}one size fits all\char`\"{}. That is the torque warning limit of motor 1 will apply to motor 7 and vice versa.\+Set the modes of the pucks 
\end{DoxyReturn}
\hypertarget{classosa_b_h8__280_a970f68ef50c92a9634f3a9ed89e64144}{}\index{osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}!Set\+Positions@{Set\+Positions}}
\index{Set\+Positions@{Set\+Positions}!osa\+B\+H8\+\_\+280@{osa\+B\+H8\+\_\+280}}
\subsubsection[{Set\+Positions}]{\setlength{\rightskip}{0pt plus 5cm}{\bf osa\+B\+H8\+\_\+280\+::\+Errno} osa\+B\+H8\+\_\+280\+::\+Set\+Positions (
\begin{DoxyParamCaption}
\item[{const {\bf vct\+Dynamic\+Vector}$<$ double $>$ \&}]{positions}
\end{DoxyParamCaption}
)}\label{classosa_b_h8__280_a970f68ef50c92a9634f3a9ed89e64144}


Send joints positions. 

The B\+H8\+\_\+280 has relative encoders, which means that you must \char`\"{}zero\char`\"{} the encoders each time the B\+H8\+\_\+280 is powered. For this you manually move the B\+H8\+\_\+280 to a know configuration and then call Send\+Position. First, the safety module is turned off to avoid triggering a velocity fault. Then, the joints positions are converted to encoder counts and each position is overwritten by \char`\"{}setting\char`\"{} the position on each puck. Finally, the safety module is turned back on. Note that this does not \char`\"{}move\char`\"{} the robot, it only tells each puck the absolute position of its encoder. 
\begin{DoxyParams}{Parameters}
{\em positions\mbox{[}in\mbox{]}} & The motor positions in radians \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
E\+S\+U\+C\+C\+E\+S\+S if no error occurred. E\+F\+A\+I\+L\+U\+R\+E otherwise. 
\end{DoxyReturn}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/\+Users/anton/devel/cisst-\/saw/saw\+Barrett/include/saw\+Barrett/\hyperlink{osa_b_h8__280_8h}{osa\+B\+H8\+\_\+280.\+h}\end{DoxyCompactItemize}
