\hypertarget{classnmr_bernstein_polynomial_line_integral}{\section{nmr\-Bernstein\-Polynomial\-Line\-Integral Class Reference}
\label{classnmr_bernstein_polynomial_line_integral}\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
}


{\ttfamily \#include $<$nmr\-Bernstein\-Polynomial\-Line\-Integral.\-h$>$}

\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structnmr_bernstein_polynomial_line_integral_1_1_profiling_info}{Profiling\-Info}
\item 
struct \hyperlink{structnmr_bernstein_polynomial_line_integral_1_1_term_summation_element}{Term\-Summation\-Element}
\end{DoxyCompactItemize}
\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef \\*
\hyperlink{classnmr_polynomial_base_a72f0bc16b225e4708bcf15a77ba206e3}{nmr\-Polynomial\-Base\-::\-Value\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_ab1d3f80540e0791f359e53b3ef074a86}{Value\-Type}
\item 
typedef \\*
\hyperlink{classnmr_polynomial_base_a666e909572cf22856c965d47f243a633}{nmr\-Polynomial\-Base\-::\-Variable\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_a229f7cb4c93c33c1b2a3de23d4f3460b}{Variable\-Type}
\item 
typedef \\*
\hyperlink{classnmr_polynomial_base_aae95477e451ddc7d3ee3f41cbdaadde2}{nmr\-Polynomial\-Base\-::\-Variable\-Index\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_a125fa9ed7f5718e92272974aee68b27a}{Variable\-Index\-Type}
\item 
typedef \\*
\hyperlink{classnmr_polynomial_base_a8693efdfc8585ccb49abea69f74f3eef}{nmr\-Polynomial\-Base\-::\-Coefficient\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}{Coefficient\-Type}
\item 
typedef \\*
\hyperlink{classnmr_polynomial_base_a58607c884bf2e6725a77ed4d9e14ba26}{nmr\-Polynomial\-Base\-::\-Power\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_a0e07aee2cb7c5f3f5d2c1f95cd4e9abf}{Power\-Type}
\item 
typedef \hyperlink{classnmr_bernstein_polynomial}{nmr\-Bernstein\-Polynomial} \hyperlink{classnmr_bernstein_polynomial_line_integral_a5c7945eacbf7d3d225de9d11bbac138c}{Integrand\-Type}
\item 
typedef \\*
\hyperlink{classnmr_polynomial_term_power_index_a09f482da776cfb829e26ad1fb381ab94}{nmr\-Polynomial\-Term\-Power\-Index\-::\-Multinomial\-Coefficient\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_a284a932e77c5c38a5d6959c4992d5300}{Multinomial\-Type}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classnmr_bernstein_polynomial_line_integral_a792ce0eb930e6e952b0d6db4374b4854}{nmr\-Bernstein\-Polynomial\-Line\-Integral} (const \hyperlink{classnmr_bernstein_polynomial_line_integral_a5c7945eacbf7d3d225de9d11bbac138c}{Integrand\-Type} \&integrand)
\item 
void \hyperlink{classnmr_bernstein_polynomial_line_integral_ace2bdff4c8e8c70d7e5a73284225ae49}{Update\-Integration\-Tableau} ()
\item 
\hyperlink{classnmr_bernstein_polynomial_line_integral_ab1d3f80540e0791f359e53b3ef074a86}{Value\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_aa0715104b8922688ed16042b410f7d82}{Evaluate\-For\-Segment} (const \hyperlink{classnmr_bernstein_polynomial_line_integral_a229f7cb4c93c33c1b2a3de23d4f3460b}{Variable\-Type} p0\mbox{[}$\,$\mbox{]}, const \hyperlink{classnmr_bernstein_polynomial_line_integral_a229f7cb4c93c33c1b2a3de23d4f3460b}{Variable\-Type} p1\mbox{[}$\,$\mbox{]}, const \hyperlink{classnmr_bernstein_polynomial_line_integral_a229f7cb4c93c33c1b2a3de23d4f3460b}{Variable\-Type} gradient\-Norm, const double roundoff\-Tolerance=\hyperlink{classnmr_bernstein_polynomial_line_integral_acd99dd062ecb011d518908d73b5f6c80}{Default\-Roundoff\-Tolerance}, \hyperlink{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}{Coefficient\-Type} const $\ast$coefficients=N\-U\-L\-L)
\item 
const \hyperlink{classnmr_bernstein_polynomial_line_integral_a5c7945eacbf7d3d225de9d11bbac138c}{Integrand\-Type} \& \hyperlink{classnmr_bernstein_polynomial_line_integral_a77d948c760c2886f75ac0b9ad5855e8d}{Get\-Integrand} () const 
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
static const double \hyperlink{classnmr_bernstein_polynomial_line_integral_acd99dd062ecb011d518908d73b5f6c80}{Default\-Roundoff\-Tolerance}
\end{DoxyCompactItemize}
\subsection*{Protected Types}
\begin{DoxyCompactItemize}
\item 
typedef std\-::vector$<$ \hyperlink{classnmr_bernstein_polynomial_line_integral_a0e07aee2cb7c5f3f5d2c1f95cd4e9abf}{Power\-Type} $>$ \hyperlink{classnmr_bernstein_polynomial_line_integral_a16dae5a5a7adabc4c3356c857aeb3841}{Power\-Index\-Type}
\item 
typedef std\-::vector\\*
$<$ \hyperlink{structnmr_bernstein_polynomial_line_integral_1_1_term_summation_element}{Term\-Summation\-Element} $>$ \hyperlink{classnmr_bernstein_polynomial_line_integral_a1d31908eb8195d1c00427f12dee7fe6b}{Single\-Term\-Integration\-Tableau}
\item 
typedef std\-::vector\\*
$<$ \hyperlink{classnmr_bernstein_polynomial_line_integral_a1d31908eb8195d1c00427f12dee7fe6b}{Single\-Term\-Integration\-Tableau} $>$ \hyperlink{classnmr_bernstein_polynomial_line_integral_a60deb00991c5e0971d60280bcbb7a405}{Polynomial\-Integration\-Tableau}
\item 
typedef std\-::vector\\*
$<$ \hyperlink{classnmr_bernstein_polynomial_line_integral_a125fa9ed7f5718e92272974aee68b27a}{Variable\-Index\-Type} $>$ \hyperlink{classnmr_bernstein_polynomial_line_integral_ad240bb2714fe8f3ce33ba2fa696931f8}{Index\-Container\-For\-Zero\-Variables}
\end{DoxyCompactItemize}
\subsection*{Static Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classnmr_bernstein_polynomial_line_integral_ab1d3f80540e0791f359e53b3ef074a86}{Value\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_a7adbcbff96185a3c803f8e0afae7c263}{Integrate\-Single\-Term} (const \hyperlink{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}{Coefficient\-Type} term\-Coefficient, const \hyperlink{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}{Coefficient\-Type} gradient\-Norm, const \hyperlink{classnmr_polynomial_term_power_index}{nmr\-Polynomial\-Term\-Power\-Index} \&term\-Index, const \hyperlink{classnmr_multi_variable_power_basis}{nmr\-Multi\-Variable\-Power\-Basis} \&powers\-At\-P0, const \hyperlink{classnmr_multi_variable_power_basis}{nmr\-Multi\-Variable\-Power\-Basis} \&powers\-At\-P1, const double roundoff\-Tolerance=\hyperlink{classnmr_bernstein_polynomial_line_integral_acd99dd062ecb011d518908d73b5f6c80}{Default\-Roundoff\-Tolerance})
\item 
static \hyperlink{classnmr_bernstein_polynomial_line_integral_ab1d3f80540e0791f359e53b3ef074a86}{Value\-Type} \hyperlink{classnmr_bernstein_polynomial_line_integral_af8a264777d4cea8caef1f09a15ccae1c}{Integrate\-Single\-Term} (const \hyperlink{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}{Coefficient\-Type} term\-Coefficient, const \hyperlink{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}{Coefficient\-Type} gradient\-Norm, const \hyperlink{classnmr_bernstein_polynomial_line_integral_a0e07aee2cb7c5f3f5d2c1f95cd4e9abf}{Power\-Type} term\-Degree, const \hyperlink{classnmr_bernstein_polynomial_line_integral_a1d31908eb8195d1c00427f12dee7fe6b}{Single\-Term\-Integration\-Tableau} \&term\-Integration\-Tableau, const \hyperlink{classnmr_multi_variable_power_basis}{nmr\-Multi\-Variable\-Power\-Basis} \&powers\-At\-P0, const \hyperlink{classnmr_multi_variable_power_basis}{nmr\-Multi\-Variable\-Power\-Basis} \&powers\-At\-P1, const \hyperlink{classnmr_bernstein_polynomial_line_integral_ad240bb2714fe8f3ce33ba2fa696931f8}{Index\-Container\-For\-Zero\-Variables} \&zeros\-Of\-P0, const \hyperlink{classnmr_bernstein_polynomial_line_integral_ad240bb2714fe8f3ce33ba2fa696931f8}{Index\-Container\-For\-Zero\-Variables} \&zeros\-Of\-P1)
\item 
static void \hyperlink{classnmr_bernstein_polynomial_line_integral_a8e151090a2dd8cb6e6ec5f9f3595bfa7}{Initialize\-Polynomial\-Integration\-Tableau} (const \hyperlink{classnmr_bernstein_polynomial_line_integral_a5c7945eacbf7d3d225de9d11bbac138c}{Integrand\-Type} \&integrand, \hyperlink{classnmr_bernstein_polynomial_line_integral_a60deb00991c5e0971d60280bcbb7a405}{Polynomial\-Integration\-Tableau} \&tableau)
\item 
static void \hyperlink{classnmr_bernstein_polynomial_line_integral_a6ff825644582e0e351f559f27fd0c36f}{Initialize\-Single\-Term\-Integration\-Tableau} (const \hyperlink{classnmr_polynomial_term_power_index}{nmr\-Polynomial\-Term\-Power\-Index} \&term\-Index, \hyperlink{classnmr_bernstein_polynomial_line_integral_a1d31908eb8195d1c00427f12dee7fe6b}{Single\-Term\-Integration\-Tableau} \&term\-Tableau)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{classnmr_bernstein_polynomial_line_integral_a5c7945eacbf7d3d225de9d11bbac138c}{Integrand\-Type} \& \hyperlink{classnmr_bernstein_polynomial_line_integral_adbc106d66e19ba746e42de7fda86782c}{Integrand}
\item 
\hyperlink{classnmr_multi_variable_power_basis_a7aea4d2b9847560899648720ee61b988}{nmr\-Multi\-Variable\-Power\-Basis\-::\-Standard\-Power\-Basis} \hyperlink{classnmr_bernstein_polynomial_line_integral_a2afceb5c30ca047d1e04fd5133843f63}{Powers\-At\-P0}
\item 
\hyperlink{classnmr_multi_variable_power_basis_a7aea4d2b9847560899648720ee61b988}{nmr\-Multi\-Variable\-Power\-Basis\-::\-Standard\-Power\-Basis} \hyperlink{classnmr_bernstein_polynomial_line_integral_aa7a7f9670060b02df2585e72b9895162}{Powers\-At\-P1}
\item 
\hyperlink{classnmr_bernstein_polynomial_line_integral_a60deb00991c5e0971d60280bcbb7a405}{Polynomial\-Integration\-Tableau} \hyperlink{classnmr_bernstein_polynomial_line_integral_a456c109c5eae6cf3194a6e5aae8a6ec0}{Integration\-Tableau}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
class \hyperlink{classnmr_bernstein_polynomial_line_integral}{nmr\-Bernstein\-Polynomial\-Line\-Integral}

Evaluates the line integral of a Bernstein polynomial in n variables. The class is initialized with the integrand polynomial. To evaluate the integral for a segment, call the function \hyperlink{classnmr_bernstein_polynomial_line_integral_aa0715104b8922688ed16042b410f7d82}{Evaluate\-For\-Segment()} and give the coordinates of two points in n-\/space between which is the line segment to be integrated.

The integration method iterates for each term of the integrand, and evaluates the integral for the term, then sums all the term integrals together. The following paragraphs should be compiled by La\-Tex to be visualized as formulas.

For the purpose of this discussion we shall use coordinate indexes starting with 0 instead of the mathematical convention of 1, to correspond to the indexing in C.

Let $ E = \{\mathbf{x} \in \mathbf{R}^n | \sum_{i=0}^{n-1} x_i = 1\} $ be the ``barycentric'' plane. Let $ \mathbf{u}_0, \mathbf{u}_1 \in E $ be two points in the plane. We want to integrate a (Bernstein) polynomial $ p(\mathbf{x}) $ along the line segment $ (\mathbf{u}_0, \mathbf{u}_1) $. For simplicity, we will show here the formula for the integration of a single term of the polynomial, given by $ B_{\mathbf{p}}^{d} $. We know that we can parametrize $ \mathbf{x} $ in the segment as\-:

\begin{eqnarray*} \mathbf{x} & = & \mathbf{x}(t) \\ & = & (1-t)\mathbf{u}_0 + t\mathbf{u}_1 \end{eqnarray*}

We note that $\nabla \mathbf{x}(t) = \mathbf{u}_1 - \mathbf{u}_0$. To evaluate the integral using the parametrized version, we need to multiply the function $\mathbf{x}(t)$ by the norm of the gradient\-:

\begin{eqnarray*} \int_{\mathbf{u}_0}^{\mathbf{u}_1} B_{\mathbf{p}}^{d}(\mathbf{x}) d\mathbf{x} & = & \int_{0}^{1} B_{\mathbf{p}}^{d} (\mathbf{x}(t)) || \nabla \mathbf{x}(t) || dt \\ & = & ||\mathbf{u}_1 - \mathbf{u}_0 || \frac{1}{d+1} \sum_{\mathbf{q} \leq \mathbf{p}} B_{\mathbf{q}}^{|\mathbf{q}|} (\mathbf{u}_0) B_{\mathbf{p} - \mathbf{q}}^{|\mathbf{p} - \mathbf{q}|} (\mathbf{u}_1) \end{eqnarray*}

where $d$ is the degree of the Bernstein term; $\mathbf{p}$, $\mathbf{q}$ are $n$-\/length lists of powers of the corresponding variables of the polynomial, s.\-t. $|\mathbf{p}| = d$; $|\cdot|$ is the operator of summing the elements (powers) in the list; and $B_{\mathbf{k}}^m(\mathbf{x})$ is the Bernstein term \[ B_\mathbf{k}^m(\mathbf{x}) = \left( \begin{array}{@{}c@{}} m \\ \mathbf{k} \end{array} \right) x_0^{k_0} x_1^{k_1} \cdots x_{n-1}^{k_{n-1}} \]

The formulas above evaluate the line integral when $\mathbf{u}_0$, $\mathbf{u}_1$, and $\mathbf{x}(t)$ are all in barycentric coordinates. This formula produces erroneous result if we want to compute the integral in the Cartesian space, as it does not take the Cartesian distances into account. For example, consider a tetrahedron with a constant density function. The integral between two points which are given in barycentric coordinates will be the same regardless of the size of the tetrahedron. But for a tetrahedron twice as large, the segment is twice as long, and we integrate the same constant density function over a doubled distance, which should have yielded a doubled integral value. To correct this error, all we need is to re-\/formulate the gradient. Instead of taking the gradient in barycentric coordinates, we will take it in Cartesian coordinates. Thus the scaling of the integral should change from $||\mathbf{u}_1 - \mathbf{u}_0 ||$ to $||\mathbf{x}_1 - \mathbf{x}_0 ||$, where $\mathbf{x}_0$ and $\mathbf{x}_1$ are the ends of the segment given in Cartesian coordinates.

For an actual development of this formula, see Russ Taylor's technical paper on Bernstein Polynomial Properties.

\begin{DoxyNote}{Note}
In the current implementation, we convert directly (using pointer cast) between the types '\hyperlink{classnmr_multi_index_counter_a0632b941a7d18df347174b4345d73d01}{nmr\-Multi\-Index\-Counter\-::\-Index\-Type} $\ast$' and '\hyperlink{classnmr_polynomial_term_power_index_a2eec01c3a2c3f56f47982ceffd8e36ed}{nmr\-Polynomial\-Term\-Power\-Index\-::\-Power\-Type} $\ast$'. Make sure that the two types are compatible in size. 
\end{DoxyNote}


\subsection{Member Typedef Documentation}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Coefficient\-Type@{Coefficient\-Type}}
\index{Coefficient\-Type@{Coefficient\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Coefficient\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf nmr\-Polynomial\-Base\-::\-Coefficient\-Type} {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Coefficient\-Type}}}\label{classnmr_bernstein_polynomial_line_integral_a0dc7480d6f60af6d3d8da6e32444edf7}
\hypertarget{classnmr_bernstein_polynomial_line_integral_ad240bb2714fe8f3ce33ba2fa696931f8}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Index\-Container\-For\-Zero\-Variables@{Index\-Container\-For\-Zero\-Variables}}
\index{Index\-Container\-For\-Zero\-Variables@{Index\-Container\-For\-Zero\-Variables}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Index\-Container\-For\-Zero\-Variables}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::vector$<${\bf Variable\-Index\-Type}$>$ {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Index\-Container\-For\-Zero\-Variables}\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_ad240bb2714fe8f3ce33ba2fa696931f8}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a5c7945eacbf7d3d225de9d11bbac138c}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Integrand\-Type@{Integrand\-Type}}
\index{Integrand\-Type@{Integrand\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Integrand\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf nmr\-Bernstein\-Polynomial} {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Integrand\-Type}}}\label{classnmr_bernstein_polynomial_line_integral_a5c7945eacbf7d3d225de9d11bbac138c}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a284a932e77c5c38a5d6959c4992d5300}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Multinomial\-Type@{Multinomial\-Type}}
\index{Multinomial\-Type@{Multinomial\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Multinomial\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf nmr\-Polynomial\-Term\-Power\-Index\-::\-Multinomial\-Coefficient\-Type} {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Multinomial\-Type}}}\label{classnmr_bernstein_polynomial_line_integral_a284a932e77c5c38a5d6959c4992d5300}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a60deb00991c5e0971d60280bcbb7a405}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Polynomial\-Integration\-Tableau@{Polynomial\-Integration\-Tableau}}
\index{Polynomial\-Integration\-Tableau@{Polynomial\-Integration\-Tableau}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Polynomial\-Integration\-Tableau}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::vector$<${\bf Single\-Term\-Integration\-Tableau}$>$ {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Polynomial\-Integration\-Tableau}\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a60deb00991c5e0971d60280bcbb7a405}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a16dae5a5a7adabc4c3356c857aeb3841}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Power\-Index\-Type@{Power\-Index\-Type}}
\index{Power\-Index\-Type@{Power\-Index\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Power\-Index\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::vector$<${\bf Power\-Type}$>$ {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Power\-Index\-Type}\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a16dae5a5a7adabc4c3356c857aeb3841}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a0e07aee2cb7c5f3f5d2c1f95cd4e9abf}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Power\-Type@{Power\-Type}}
\index{Power\-Type@{Power\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Power\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf nmr\-Polynomial\-Base\-::\-Power\-Type} {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Power\-Type}}}\label{classnmr_bernstein_polynomial_line_integral_a0e07aee2cb7c5f3f5d2c1f95cd4e9abf}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a1d31908eb8195d1c00427f12dee7fe6b}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Single\-Term\-Integration\-Tableau@{Single\-Term\-Integration\-Tableau}}
\index{Single\-Term\-Integration\-Tableau@{Single\-Term\-Integration\-Tableau}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Single\-Term\-Integration\-Tableau}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::vector$<${\bf Term\-Summation\-Element}$>$ {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Single\-Term\-Integration\-Tableau}\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a1d31908eb8195d1c00427f12dee7fe6b}
\hypertarget{classnmr_bernstein_polynomial_line_integral_ab1d3f80540e0791f359e53b3ef074a86}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Value\-Type@{Value\-Type}}
\index{Value\-Type@{Value\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Value\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf nmr\-Polynomial\-Base\-::\-Value\-Type} {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Value\-Type}}}\label{classnmr_bernstein_polynomial_line_integral_ab1d3f80540e0791f359e53b3ef074a86}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a125fa9ed7f5718e92272974aee68b27a}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Variable\-Index\-Type@{Variable\-Index\-Type}}
\index{Variable\-Index\-Type@{Variable\-Index\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Variable\-Index\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf nmr\-Polynomial\-Base\-::\-Variable\-Index\-Type} {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Variable\-Index\-Type}}}\label{classnmr_bernstein_polynomial_line_integral_a125fa9ed7f5718e92272974aee68b27a}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a229f7cb4c93c33c1b2a3de23d4f3460b}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Variable\-Type@{Variable\-Type}}
\index{Variable\-Type@{Variable\-Type}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Variable\-Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf nmr\-Polynomial\-Base\-::\-Variable\-Type} {\bf nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Variable\-Type}}}\label{classnmr_bernstein_polynomial_line_integral_a229f7cb4c93c33c1b2a3de23d4f3460b}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a792ce0eb930e6e952b0d6db4374b4854}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{nmr\-Bernstein\-Polynomial\-Line\-Integral}]{\setlength{\rightskip}{0pt plus 5cm}nmr\-Bernstein\-Polynomial\-Line\-Integral\-::nmr\-Bernstein\-Polynomial\-Line\-Integral (
\begin{DoxyParamCaption}
\item[{const {\bf Integrand\-Type} \&}]{integrand}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classnmr_bernstein_polynomial_line_integral_a792ce0eb930e6e952b0d6db4374b4854}


\subsection{Member Function Documentation}
\hypertarget{classnmr_bernstein_polynomial_line_integral_aa0715104b8922688ed16042b410f7d82}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Evaluate\-For\-Segment@{Evaluate\-For\-Segment}}
\index{Evaluate\-For\-Segment@{Evaluate\-For\-Segment}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Evaluate\-For\-Segment}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Value\-Type} nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Evaluate\-For\-Segment (
\begin{DoxyParamCaption}
\item[{const {\bf Variable\-Type}}]{p0\mbox{[}$\,$\mbox{]}, }
\item[{const {\bf Variable\-Type}}]{p1\mbox{[}$\,$\mbox{]}, }
\item[{const {\bf Variable\-Type}}]{gradient\-Norm, }
\item[{const double}]{roundoff\-Tolerance = {\ttfamily {\bf Default\-Roundoff\-Tolerance}}, }
\item[{{\bf Coefficient\-Type} const $\ast$}]{coefficients = {\ttfamily NULL}}
\end{DoxyParamCaption}
)}}\label{classnmr_bernstein_polynomial_line_integral_aa0715104b8922688ed16042b410f7d82}
Evaluate the line integral for the segment \mbox{[}p0..p1\mbox{]}. The formulas for the integral are in this class's main documentation.


\begin{DoxyParams}{Parameters}
{\em p0} & first vertex of the segment, given in barycentric coordinates \\
\hline
{\em p1} & second vertex of the segmend, given in barycentric coordinates \\
\hline
{\em gradient\-Norm} & the norm of the gradient, as described in the integration formula. As the inputs to this function are given in barycentric coordinates, the gradient norm must be provided from outside. The user may use the length of the segment in Cartesian coordinates or in barycentric coordinates. \\
\hline
{\em roundoff\-Tolerance} & a small positive real number. If the absolute value of a variable is $<$= roundoff\-Tolerance, it is rounded to zero, and reduces the number of iterations required for the integration. \\
\hline
{\em coefficients} & if this argument is non-\/null, then our algorithm uses externally defined coefficients, which are stored in this array. Note that the external coefficients must be in the same order as the ones in the polynomial. See \hyperlink{classnmr_polynomial_base_a2536de8569d074248e1ddc892bb4cb6d}{nmr\-Polynomial\-Base\-::\-Evaluate\-For\-Coefficients()}. Using external coefficients can improve the runtime efficiency when the integrals are computed with many sets of coefficients, and then the coefficient sets can be cached elsewhere (the polynomial only has one set of coefficients). \\
\hline
\end{DoxyParams}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a77d948c760c2886f75ac0b9ad5855e8d}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Get\-Integrand@{Get\-Integrand}}
\index{Get\-Integrand@{Get\-Integrand}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Get\-Integrand}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Integrand\-Type}\& nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Get\-Integrand (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{classnmr_bernstein_polynomial_line_integral_a77d948c760c2886f75ac0b9ad5855e8d}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a8e151090a2dd8cb6e6ec5f9f3595bfa7}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Initialize\-Polynomial\-Integration\-Tableau@{Initialize\-Polynomial\-Integration\-Tableau}}
\index{Initialize\-Polynomial\-Integration\-Tableau@{Initialize\-Polynomial\-Integration\-Tableau}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Initialize\-Polynomial\-Integration\-Tableau}]{\setlength{\rightskip}{0pt plus 5cm}static void nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Initialize\-Polynomial\-Integration\-Tableau (
\begin{DoxyParamCaption}
\item[{const {\bf Integrand\-Type} \&}]{integrand, }
\item[{{\bf Polynomial\-Integration\-Tableau} \&}]{tableau}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a8e151090a2dd8cb6e6ec5f9f3595bfa7}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a6ff825644582e0e351f559f27fd0c36f}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Initialize\-Single\-Term\-Integration\-Tableau@{Initialize\-Single\-Term\-Integration\-Tableau}}
\index{Initialize\-Single\-Term\-Integration\-Tableau@{Initialize\-Single\-Term\-Integration\-Tableau}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Initialize\-Single\-Term\-Integration\-Tableau}]{\setlength{\rightskip}{0pt plus 5cm}static void nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Initialize\-Single\-Term\-Integration\-Tableau (
\begin{DoxyParamCaption}
\item[{const {\bf nmr\-Polynomial\-Term\-Power\-Index} \&}]{term\-Index, }
\item[{{\bf Single\-Term\-Integration\-Tableau} \&}]{term\-Tableau}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a6ff825644582e0e351f559f27fd0c36f}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a7adbcbff96185a3c803f8e0afae7c263}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Integrate\-Single\-Term@{Integrate\-Single\-Term}}
\index{Integrate\-Single\-Term@{Integrate\-Single\-Term}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Integrate\-Single\-Term}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Value\-Type} nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Integrate\-Single\-Term (
\begin{DoxyParamCaption}
\item[{const {\bf Coefficient\-Type}}]{term\-Coefficient, }
\item[{const {\bf Coefficient\-Type}}]{gradient\-Norm, }
\item[{const {\bf nmr\-Polynomial\-Term\-Power\-Index} \&}]{term\-Index, }
\item[{const {\bf nmr\-Multi\-Variable\-Power\-Basis} \&}]{powers\-At\-P0, }
\item[{const {\bf nmr\-Multi\-Variable\-Power\-Basis} \&}]{powers\-At\-P1, }
\item[{const double}]{roundoff\-Tolerance = {\ttfamily {\bf Default\-Roundoff\-Tolerance}}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a7adbcbff96185a3c803f8e0afae7c263}
Integration of a single term of the integrand polynomial, using the formula developed above.


\begin{DoxyParams}{Parameters}
{\em term\-Coefficient} & the coefficient of the integrand term \\
\hline
{\em gradient\-Norm} & the norm of the gradient, which is a constant equal to the distance between the vertices of the segment. \\
\hline
{\em term\-Index} & the power index of the integrand term \\
\hline
{\em powers\-At\-P0} & pre-\/computed power basis for all the variables at the \char`\"{}\-P0\char`\"{} vertex. In old versions, we used \hyperlink{classnmr_standard_polynomial}{nmr\-Standard\-Polynomial} as a container for the powers. It is now replaced with the independent object \hyperlink{classnmr_multi_variable_power_basis}{nmr\-Multi\-Variable\-Power\-Basis}. \\
\hline
{\em powers\-At\-P1} & pre-\/computed power basis for all the variables at the \char`\"{}\-P1\char`\"{} vertex. \\
\hline
{\em roundoff\-Tolerance} & a small positive real number. If the absolute value of a variable is $<$= roundoff\-Tolerance, it is rounded to zero, and reduces the number of iterations required for the integration. \\
\hline
\end{DoxyParams}
\hypertarget{classnmr_bernstein_polynomial_line_integral_af8a264777d4cea8caef1f09a15ccae1c}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Integrate\-Single\-Term@{Integrate\-Single\-Term}}
\index{Integrate\-Single\-Term@{Integrate\-Single\-Term}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Integrate\-Single\-Term}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Value\-Type} nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Integrate\-Single\-Term (
\begin{DoxyParamCaption}
\item[{const {\bf Coefficient\-Type}}]{term\-Coefficient, }
\item[{const {\bf Coefficient\-Type}}]{gradient\-Norm, }
\item[{const {\bf Power\-Type}}]{term\-Degree, }
\item[{const {\bf Single\-Term\-Integration\-Tableau} \&}]{term\-Integration\-Tableau, }
\item[{const {\bf nmr\-Multi\-Variable\-Power\-Basis} \&}]{powers\-At\-P0, }
\item[{const {\bf nmr\-Multi\-Variable\-Power\-Basis} \&}]{powers\-At\-P1, }
\item[{const {\bf Index\-Container\-For\-Zero\-Variables} \&}]{zeros\-Of\-P0, }
\item[{const {\bf Index\-Container\-For\-Zero\-Variables} \&}]{zeros\-Of\-P1}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_af8a264777d4cea8caef1f09a15ccae1c}
Integration of a single term of the integrand polynomial using a pre-\/computed tableau which stores the power-\/indices of all the summation elements constituting the term.


\begin{DoxyParams}{Parameters}
{\em term\-Coefficient} & the coefficient of the integrand term \\
\hline
{\em gradient\-Norm} & the norm of the gradient, which is a constant equal to the distance between the endpoints of the segment. \\
\hline
{\em term\-Degree} & the degree of the integrand term. The product (gradient\-Norm $\ast$ (term\-Degree+1)) is a denominator of the integral. \\
\hline
{\em powers\-At\-P0} & pre-\/computed power basis for all the variables at the \char`\"{}\-P0\char`\"{} vertex. \\
\hline
{\em powers\-At\-P1} & pre-\/computed power basis for all the variables at the \char`\"{}\-P1\char`\"{} vertex. \\
\hline
{\em zeros\-Of\-P0} & indices of the P0 variables which are equal to zero. Summation element in which the power of a zero variable is positive are skipped. \\
\hline
{\em zeros\-Of\-P1} & indices of the P1 variables which are equal to zero. \\
\hline
{\em profile\-Info} & (optional) pointer to a struct that stores inegration profiling. \\
\hline
\end{DoxyParams}
\hypertarget{classnmr_bernstein_polynomial_line_integral_ace2bdff4c8e8c70d7e5a73284225ae49}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Update\-Integration\-Tableau@{Update\-Integration\-Tableau}}
\index{Update\-Integration\-Tableau@{Update\-Integration\-Tableau}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Update\-Integration\-Tableau}]{\setlength{\rightskip}{0pt plus 5cm}void nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Update\-Integration\-Tableau (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{classnmr_bernstein_polynomial_line_integral_ace2bdff4c8e8c70d7e5a73284225ae49}
As the integrand may change since the initialization of this object, this method lets the user update the integration tableau after changing the integrand (e.\-g., by adding or removing terms). 

\subsection{Member Data Documentation}
\hypertarget{classnmr_bernstein_polynomial_line_integral_acd99dd062ecb011d518908d73b5f6c80}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Default\-Roundoff\-Tolerance@{Default\-Roundoff\-Tolerance}}
\index{Default\-Roundoff\-Tolerance@{Default\-Roundoff\-Tolerance}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Default\-Roundoff\-Tolerance}]{\setlength{\rightskip}{0pt plus 5cm}const double nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Default\-Roundoff\-Tolerance\hspace{0.3cm}{\ttfamily [static]}}}\label{classnmr_bernstein_polynomial_line_integral_acd99dd062ecb011d518908d73b5f6c80}
\hypertarget{classnmr_bernstein_polynomial_line_integral_adbc106d66e19ba746e42de7fda86782c}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Integrand@{Integrand}}
\index{Integrand@{Integrand}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Integrand}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Integrand\-Type}\& nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Integrand\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_adbc106d66e19ba746e42de7fda86782c}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a456c109c5eae6cf3194a6e5aae8a6ec0}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Integration\-Tableau@{Integration\-Tableau}}
\index{Integration\-Tableau@{Integration\-Tableau}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Integration\-Tableau}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Polynomial\-Integration\-Tableau} nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Integration\-Tableau\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a456c109c5eae6cf3194a6e5aae8a6ec0}
\hypertarget{classnmr_bernstein_polynomial_line_integral_a2afceb5c30ca047d1e04fd5133843f63}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Powers\-At\-P0@{Powers\-At\-P0}}
\index{Powers\-At\-P0@{Powers\-At\-P0}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Powers\-At\-P0}]{\setlength{\rightskip}{0pt plus 5cm}{\bf nmr\-Multi\-Variable\-Power\-Basis\-::\-Standard\-Power\-Basis} nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Powers\-At\-P0\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_a2afceb5c30ca047d1e04fd5133843f63}
\hypertarget{classnmr_bernstein_polynomial_line_integral_aa7a7f9670060b02df2585e72b9895162}{\index{nmr\-Bernstein\-Polynomial\-Line\-Integral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}!Powers\-At\-P1@{Powers\-At\-P1}}
\index{Powers\-At\-P1@{Powers\-At\-P1}!nmrBernsteinPolynomialLineIntegral@{nmr\-Bernstein\-Polynomial\-Line\-Integral}}
\subsubsection[{Powers\-At\-P1}]{\setlength{\rightskip}{0pt plus 5cm}{\bf nmr\-Multi\-Variable\-Power\-Basis\-::\-Standard\-Power\-Basis} nmr\-Bernstein\-Polynomial\-Line\-Integral\-::\-Powers\-At\-P1\hspace{0.3cm}{\ttfamily [protected]}}}\label{classnmr_bernstein_polynomial_line_integral_aa7a7f9670060b02df2585e72b9895162}


The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
/home/adeguet1/catkin\-\_\-ws/src/cisst-\/saw/cisst/cisst\-Numerical/\hyperlink{nmr_bernstein_polynomial_line_integral_8h}{nmr\-Bernstein\-Polynomial\-Line\-Integral.\-h}\end{DoxyCompactItemize}
