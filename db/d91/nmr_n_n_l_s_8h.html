<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>cisst-saw: /Users/anton/devel/cisst-saw/cisst/cisstNumerical/nmrNNLS.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cisst-saw
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_01c7098825479068673915343d9a5d18.html">cisst</a></li><li class="navelem"><a class="el" href="../../dir_1161a029fb9fd24940c9e5b6c1557355.html">cisstNumerical</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">nmrNNLS.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declaration of nmrNNLS.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="../../da/d57/cmn_throw_8h_source.html">cisstCommon/cmnThrow.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d3/d31/vct_dynamic_matrix_8h_source.html">cisstVector/vctDynamicMatrix.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d7/d65/nmr_netlib_8h_source.html">cisstNumerical/nmrNetlib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../de/da9/nmr_export_8h_source.html">cisstNumerical/nmrExport.h</a>&gt;</code><br />
</div>
<p><a href="../../db/d91/nmr_n_n_l_s_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html">nmrNNLSDynamicData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data for NNLS problem (Dynamic).  <a href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d7d/classnmr_n_n_l_s_dynamic_data_1_1_friend.html">nmrNNLSDynamicData::Friend</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Algorithm NNLS:</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>&mdash; update this doc &mdash;</p>
<p>These functions are wrappers around the LAPACK routine dgesvd, therefore they share some features with the LAPACK routine: </p><ol>
<li>
They return <img class="formulaInl" alt="$ V^{T} $" src="../../form_202.png"/>, not <img class="formulaInl" alt="$ V $" src="../../form_203.png"/>. </li>
<li>
On exit, the content of A is altered. </li>
<li>
The vectors and matrices must be compact, i.e. use a contiguous block of memory. </li>
</ol>
<p>The <a class="el" href="../../db/d91/nmr_n_n_l_s_8h.html#afd1108e6bc3e5d308f34bc7b31fd3278">nmrNNLS</a> functions add the following features: </p><ol>
<li>
A simplified interface to the cisstVector dynamic matrices. </li>
<li>
The possibility to use any storage order, i.e. <a class="el" href="../../d8/d36/vct_forward_declarations_8h.html#a45ba752f741240bf765417ebc8130d62">VCT_ROW_MAJOR</a> or <a class="el" href="../../d8/d36/vct_forward_declarations_8h.html#a432cdf8923afaf82f551450ad4034746">VCT_COL_MAJOR</a>. In the specific case of NNLS, the storage order can be treated as a transpose and the properties of the decomposition are preserved (<a class="el" href="../../db/d91/nmr_n_n_l_s_8h.html#afd1108e6bc3e5d308f34bc7b31fd3278">nmrNNLS</a> will swap U and Vt pointers). This is performed at no extra cost, i.e. no copy back and forth of the elements nor extra memory allocation. </li>
<li>
Input validation checks are performed, i.e. an std::runtime_error exception will be thrown if the sizes or storage order don't match or if the containers are not compact. </li>
<li>
Helper classes to allocate memory for the output and workspace: nmrNNLSFixedSizeData and <a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html" title="Data for NNLS problem (Dynamic). ">nmrNNLSDynamicData</a>. </li>
</ol>
<p>There are different ways to call this function to compute the NNLS of the matrix A. These correspond to different overloaded <a class="el" href="../../db/d91/nmr_n_n_l_s_8h.html#afd1108e6bc3e5d308f34bc7b31fd3278">nmrNNLS</a> functions: </p><ol>
<li>
<p class="startli">Using a preallocated data object.</p>
<p>The user creates the input matrix A: </p><div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(12, 24 , <a class="code" href="../../d8/d36/vct_forward_declarations_8h.html#a45ba752f741240bf765417ebc8130d62">VCT_ROW_MAJOR</a>); <span class="comment">// 12 x 24 matrix</span></div>
<div class="line"><a class="code" href="../../dc/d50/group__cisst_vector.html#ga0d25660a2dc6ef9c093f6f6b2804d2d0">vctRandom</a>(A, -10.0, 10.0);</div>
</div><!-- fragment --><p> The user allocates a data object which could be of type nmrNNLSFixedSizeData or <a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html" title="Data for NNLS problem (Dynamic). ">nmrNNLSDynamicData</a>. corresponding to fixed size or dynamic matrix A: </p><div class="fragment"><div class="line"><a class="code" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html">nmrNNLSDynamicData</a> data(A);</div>
</div><!-- fragment --><p> Call the nmrNNLS function: </p><div class="fragment"><div class="line"><a class="code" href="../../db/d91/nmr_n_n_l_s_8h.html#a66392d56623e80ae0b6962a40d6da77c">nmrNNLS</a>(A, data);</div>
</div><!-- fragment --><p> The content of input matrix A is modified by this routine. The matrices U, Vt and vector S are available through the following methods </p><div class="fragment"><div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;U: &quot;</span> &lt;&lt; data.U() &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;S: &quot;</span> &lt;&lt; data.S() &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;V: &quot;</span> &lt;&lt; data.Vt().Transpose() &lt;&lt; std::endl;</div>
</div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">The user provides the matrices U, Vt, and vector S.</p>
<p>The User allocates memory for these matrices and vector: </p><div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(5, 4);</div>
<div class="line"><a class="code" href="../../dc/d50/group__cisst_vector.html#ga0d25660a2dc6ef9c093f6f6b2804d2d0">vctRandom</a>(A, -10.0, 10.0);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> U(5, 5);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> Vt(4, 4);</div>
<div class="line"><a class="code" href="../../d8/d36/classvct_dynamic_vector.html">vctDynamicVector&lt;CISSTNETLIB_DOUBLE&gt;</a> S(4);</div>
</div><!-- fragment --><p> Call the NNLS routine: </p><div class="fragment"><div class="line"><a class="code" href="../../db/d91/nmr_n_n_l_s_8h.html#a66392d56623e80ae0b6962a40d6da77c">nmrNNLS</a>(A, U, S, Vt);</div>
</div><!-- fragment --><p> The NNLS function verifies that the size of the data objects matches the input, and allocates workspace memory, which is deallocated when the function ends.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The user provides the matrices U, Vt, and vector S along with workspace required by NNLS routine of LAPACK.</p>
<p class="endli">Create matrices and vector: </p><div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(5, 4);</div>
<div class="line"><a class="code" href="../../dc/d50/group__cisst_vector.html#ga0d25660a2dc6ef9c093f6f6b2804d2d0">vctRandom</a>(A, -10.0, 10.0);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> U(5, 5);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> Vt(4, 4);</div>
<div class="line"><a class="code" href="../../d8/d36/classvct_dynamic_vector.html">vctDynamicVector&lt;CISSTNETLIB_DOUBLE&gt;</a> S(4);</div>
</div><!-- fragment --><p> One also needs to allocate memory the for workspace. This approach is particularly useful when the user is using more than one numerical method from the library and is willing or need to share the workspace between them. In such as case, the user can allocate a block of memory greater than the minimum required by different methods. To help the user determine the minimum workspace required the library provides the helper function <a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html#acdb443c5bfa9547c2a4f76ae90a472dc">nmrNNLSDynamicData::WorkspaceSize()</a>. </p><div class="fragment"><div class="line"><a class="code" href="../../d8/d36/classvct_dynamic_vector.html">vctDynamicVector&lt;CISSTNETLIB_DOUBLE&gt;</a> workspace(<a class="code" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html#acdb443c5bfa9547c2a4f76ae90a472dc">nmrNNLSDynamicData::WorkspaceSize</a>(A));</div>
</div><!-- fragment --><p> Call the NNLS function: </p><div class="fragment"><div class="line"><a class="code" href="../../db/d91/nmr_n_n_l_s_8h.html#a66392d56623e80ae0b6962a40d6da77c">nmrNNLS</a>(A, U, S, Vt, workspace);</div>
</div><!-- fragment --> </li>
</ol>
<dl class="section note"><dt>Note</dt><dd>The NNLS functions make use of LAPACK routines. To activate this code, set the CISST_HAS_CISSTNETLIB flag to ON during the configuration of cisst with CMake.</dd>
<dd>
The general rule for numerical functions which depend on LAPACK is that column major matrices should be used everywhere, and that all matrices should be compact. In this case, both row major and column major are allowed but they must not be mixed in a data object. </dd></dl>
</div></td></tr>
<tr class="memitem:a66392d56623e80ae0b6962a40d6da77c"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerType &gt; </td></tr>
<tr class="memitem:a66392d56623e80ae0b6962a40d6da77c"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../db/d91/nmr_n_n_l_s_8h.html#a66392d56623e80ae0b6962a40d6da77c">nmrNNLS</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerType, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html">nmrNNLSDynamicData</a> &amp;data)  throw (std::runtime_error)</td></tr>
<tr class="separator:a66392d56623e80ae0b6962a40d6da77c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a716228881cd6386b2ed8d00eba3fe8c4"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt , class _vectorOwnerTypeWorkspace &gt; </td></tr>
<tr class="memitem:a716228881cd6386b2ed8d00eba3fe8c4"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../db/d91/nmr_n_n_l_s_8h.html#a716228881cd6386b2ed8d00eba3fe8c4">nmrNNLS</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;U, <a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;S, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;Vt, <a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeWorkspace, CISSTNETLIB_DOUBLE &gt; &amp;Workspace)</td></tr>
<tr class="separator:a716228881cd6386b2ed8d00eba3fe8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd1108e6bc3e5d308f34bc7b31fd3278"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt &gt; </td></tr>
<tr class="memitem:afd1108e6bc3e5d308f34bc7b31fd3278"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../db/d91/nmr_n_n_l_s_8h.html#afd1108e6bc3e5d308f34bc7b31fd3278">nmrNNLS</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;U, <a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;S, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;Vt)</td></tr>
<tr class="separator:afd1108e6bc3e5d308f34bc7b31fd3278"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declaration of nmrNNLS. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a66392d56623e80ae0b6962a40d6da77c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrNNLS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerType, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html">nmrNNLSDynamicData</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2">std::runtime_error</td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves the NNLS problem for a dynamic matrix using an <a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html" title="Data for NNLS problem (Dynamic). ">nmrNNLSDynamicData</a>.</p>
<p>This function checks for valid input (size, storage order and compact) and calls the LAPACK function. If the input doesn't match the data, an exception is thrown (<code>std::runtime_error</code>).</p>
<p>This function modifies the input matrix A and stores the results in the data. Each component of the result can be obtained via the const methods nmrNNLSDynamicData::U(), nmrNNLSDynamicData::S() and nmrNNLSDynamicData::Vt().</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>A matrix of size MxN, either <a class="el" href="../../dd/d81/classvct_dynamic_matrix.html" title="A matrix object of dynamic size. ">vctDynamicMatrix</a> or <a class="el" href="../../d6/dbd/classvct_dynamic_matrix_ref.html" title="Dynamic matrix referencing existing memory. ">vctDynamicMatrixRef</a>. </td></tr>
    <tr><td class="paramname">data</td><td>A data object corresponding to the input matrix.</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000009">Test:</a></b></dt><dd>nmrNNLSTest::TestDynamicColumnMajor nmrNNLSTest::TestDynamicRowMajor nmrNNLSTest::TestDynamicColumnMajorUserAlloc nmrNNLSTest::TestDynamicRowMajorUserAlloc </dd></dl>

</div>
</div>
<a class="anchor" id="a716228881cd6386b2ed8d00eba3fe8c4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt , class _vectorOwnerTypeWorkspace &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrNNLS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>Vt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeWorkspace, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>Workspace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves the NNLS problem for a dynamic matrix using the storage provided by the user for both the output (U, S, Vt) and the workspace.</p>
<p>Internally, a data is created using the storage provided by the user (see <a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html#ab32c899922b96030616bf83d5e741c55">nmrNNLSDynamicData::SetRef</a>). While the data is being build, the consistency of the output and workspace is checked. Then, the nmrNNLS(A, data) function can be used safely.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>is a reference to a dynamic matrix of size MxN </td></tr>
    <tr><td class="paramname">U,S,Vt</td><td>The output matrices and vector for NNLS </td></tr>
    <tr><td class="paramname">Workspace</td><td>The workspace for LAPACK.</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000010">Test:</a></b></dt><dd>nmrNNLSTest::TestDynamicColumnMajorUserAlloc nmrNNLSTest::TestDynamicRowMajorUserAlloc </dd></dl>

</div>
</div>
<a class="anchor" id="afd1108e6bc3e5d308f34bc7b31fd3278"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrNNLS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>Vt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves the NNLS problem for a dynamic matrix using the storage provided by the user for the output (U, S, Vt). A workspace will be dynamically allocated.</p>
<p>Internally, a data is created using the storage provided by the user (see <a class="el" href="../../d4/df7/classnmr_n_n_l_s_dynamic_data.html#a8b4529a38e1b16bbe5f805e11a2f5560">nmrNNLSDynamicData::SetRefOutput</a>). While the data is being build, the consistency of the output is checked. Then, the nmrNNLS(A, data) function can be used safely.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>is a reference to a dynamic matrix of size MxN </td></tr>
    <tr><td class="paramname">U,S,Vt</td><td>The output matrices and vector for NNLS</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000011">Test:</a></b></dt><dd>nmrNNLSTest::TestDynamicColumnMajorUserAlloc nmrNNLSTest::TestDynamicRowMajorUserAlloc</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Again, this method will dynamically allocate a workspace at each call. This is somewhat inefficient if the method is to be called many times. For a real-time task, the dynamic allocation might even break your application. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
