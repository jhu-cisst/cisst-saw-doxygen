<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>cisst-saw: /home/adeguet1/catkin_ws/src/cisst-saw/cisst/cisstNumerical/nmrPInverse.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cisst-saw
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_5c9b1b03f6e45e6a48c8e8f7b0f905ad.html">catkin_ws</a></li><li class="navelem"><a class="el" href="../../dir_7c859f3878cb32062c29919224ce2290.html">src</a></li><li class="navelem"><a class="el" href="../../dir_306b2c600c1afd12a133ff64adbfb461.html">cisst-saw</a></li><li class="navelem"><a class="el" href="../../dir_ed4b9bdbc14f2ac25a66baec3401918e.html">cisst</a></li><li class="navelem"><a class="el" href="../../dir_9722f5cf886ec1d7ef61a054011c9397.html">cisstNumerical</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">nmrPInverse.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declaration of nmrPInverse.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="../../da/d57/cmn_throw_8h_source.html">cisstCommon/cmnThrow.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d2/d24/vct_fixed_size_matrix_8h_source.html">cisstVector/vctFixedSizeMatrix.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d3/d31/vct_dynamic_matrix_8h_source.html">cisstVector/vctDynamicMatrix.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d7/d65/nmr_netlib_8h_source.html">cisstNumerical/nmrNetlib.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../d6/d98/nmr_s_v_d_8h_source.html">cisstNumerical/nmrSVD.h</a>&gt;</code><br/>
<code>#include &lt;<a class="el" href="../../de/da9/nmr_export_8h_source.html">cisstNumerical/nmrExport.h</a>&gt;</code><br/>
</div>
<p><a href="../../dc/d55/nmr_p_inverse_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d1b/classnmr_p_inverse_dynamic_data.html">nmrPInverseDynamicData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dcb/classnmr_p_inverse_dynamic_data_1_1_friend.html">nmrPInverseDynamicData::Friend</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9f/classnmr_p_inverse_fixed_size_data.html">nmrPInverseFixedSizeData&lt; _rows, _cols, _storageOrder &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d54/classnmr_p_inverse_fixed_size_data_1_1_friend.html">nmrPInverseFixedSizeData&lt; _rows, _cols, _storageOrder &gt;::Friend</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Algorithm P-Inverse: Moore-Penrose pseudo-inverse.</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>Calculates the Moore-Penrose pseudo-inverse of the M by N matrix A, and stores the result in PInverse. The singular values of A are returned in S. The left singular vectors are returned in U, and the right singular vectors are returned in V.</p>
<p><img class="formulaInl" alt="$ A^{+} = V * \Sigma^{+} * U^{T}$" src="../../form_207.png"/></p>
<p>where <img class="formulaInl" alt="$ \Sigma^{+} $" src="../../form_208.png"/> is a <img class="formulaInl" alt="$ N \times M $" src="../../form_209.png"/> matrix which is zero except for its min(m,n) diagonal elements, U is a <img class="formulaInl" alt="$ M \times M $" src="../../form_147.png"/> orthogonal matrix, and V is a <img class="formulaInl" alt="$ N \times N $" src="../../form_151.png"/> orthogonal matrix. The diagonal elements of <img class="formulaInl" alt="$ \Sigma^{+} $" src="../../form_208.png"/> are the reciprocal ofc non-zero singular values of A; they are real and non-negative, andc are returned in descending order. The first <img class="formulaInl" alt="$ \mbox{min}(m,n) $" src="../../form_210.png"/> columns of U and V are the left and right singular vectors of A.</p>
<dl class="section note"><dt>Note</dt><dd>This routine returns <img class="formulaInl" alt="$ V^{T}$" src="../../form_211.png"/>, not <img class="formulaInl" alt="$V$" src="../../form_212.png"/>.</dd>
<dd>
On exit, the content of A is altered.</dd></dl>
<p>There are three ways to call this method to compute the pseudo-inverse of the matrix A. </p>
<ol>
<li>
<p class="startli">User provides matrices <img class="formulaInl" alt="$A$" src="../../form_213.png"/> and <img class="formulaInl" alt="$A^{+}$" src="../../form_214.png"/>. The user first allocates memory for these matrices and vector.</p>
<div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(5, 4);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> PInverse(4, 5);</div>
</div><!-- fragment --><p>The user can then call the P-Inverse routine</p>
<div class="fragment"><div class="line"><a class="code" href="../../dc/d55/nmr_p_inverse_8h.html#a1f68847a352d1889c52da964d07c3944">nmrPInverse</a>(A, PInverse);</div>
</div><!-- fragment --><p>The PInverse method verifies that the size of the data objects matches the input, and allocates workspace memory, which is deallocated when the function ends. Remember that nmrPInverse alters the content of matrix A. For fixed size the function call is templated by size and row/column major, e.g.</p>
<div class="fragment"><div class="line">nmrPInverse&lt;4, 3, VCT_COL_MAJOR&gt;(A, PInverse);</div>
</div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">Using a preallocated data object. The user first creates the input matrix.</p>
<div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> input(rows, cols , <a class="code" href="../../d8/d36/vct_forward_declarations_8h.html#a45ba752f741240bf765417ebc8130d62">VCT_ROW_MAJOR</a>);</div>
</div><!-- fragment --><p>The user creates a data object which could be of type <a class="el" href="../../d1/d9f/classnmr_p_inverse_fixed_size_data.html">nmrPInverseFixedSizeData</a> or <a class="el" href="../../d6/d1b/classnmr_p_inverse_dynamic_data.html">nmrPInverseDynamicData</a> corresponding to fixed size, dynamic matrix.</p>
<div class="fragment"><div class="line"><a class="code" href="../../d6/d1b/classnmr_p_inverse_dynamic_data.html">nmrPInverseDynamicData</a> data(input);</div>
</div><!-- fragment --><p>Finally, call the nmrPInverse function:</p>
<div class="fragment"><div class="line"><a class="code" href="../../dc/d55/nmr_p_inverse_8h.html#a1f68847a352d1889c52da964d07c3944">nmrPInverse</a>(input, data);</div>
</div><!-- fragment --><p>The contents of input matrix is modified by this routine. The matrices U, Vt and vector S are available through the following methods:</p>
<div class="fragment"><div class="line">std::cout &lt;&lt; data.U()</div>
<div class="line">          &lt;&lt; data.S()</div>
<div class="line">          &lt;&lt; data.Vt()</div>
<div class="line">          &lt;&lt; data.PInverse()</div>
<div class="line">          &lt;&lt; std::endl;</div>
</div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">User provides matrix PInverse with workspace required by pseudo-inverse routine of LAPACK. User creates matrices:</p>
<div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(5, 4);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> PInverse(4, 5);</div>
</div><!-- fragment --><p>User also needs to allocate memory for workspace. This method is particularly useful when the user is using more than one numerical methods from the library and is willing to share the workspace between them. In such as case, the user can allocate the a memory greater than the maximum required by different methods. To aid the user determine the minimum workspace required (and not spend time digging LAPACK documentation) the library provides helper function nmrPInverseDynamicData::WorkspaceSize(input).</p>
<div class="fragment"><div class="line"><a class="code" href="../../d8/d36/classvct_dynamic_vector.html">vctDynamicVector&lt;CISSTNETLIB_DOUBLE&gt;</a> Work(<a class="code" href="../../d6/d1b/classnmr_p_inverse_dynamic_data.html#aee681485d8de68b460a65585fea10e68">nmrPInverseDynamicData::WorkspaceSize</a>(A));</div>
</div><!-- fragment --><p>Call the SVD function </p>
<div class="fragment"><div class="line"><a class="code" href="../../dc/d55/nmr_p_inverse_8h.html#a1f68847a352d1889c52da964d07c3944">nmrPInverse</a>(A, PInverse, Work);</div>
</div><!-- fragment --><p>For fixed size the above two steps are replaced by </p>
<div class="fragment"><div class="line"><a class="code" href="../../d1/d9f/classnmr_p_inverse_fixed_size_data.html">nmrPInverseFixedSizeData&lt;4, 3, VCT_COL_MAJOR&gt;::TypeWorkspace</a> Work;</div>
<div class="line">nmrPInverse&lt;4, 3, VCT_COL_MAJOR&gt;(A, PInverse, Work);</div>
</div><!-- fragment --><p class="endli"></p>
</li>
</ol>
<p>nmrPInverse uses <a class="el" href="../../d6/d98/nmr_s_v_d_8h.html#a52115d0e7a485c4494aa20f4f3f4ebe7">nmrSVD</a> and returns the error code of <a class="el" href="../../d6/d98/nmr_s_v_d_8h.html#a52115d0e7a485c4494aa20f4f3f4ebe7">nmrSVD</a>. See <a class="el" href="../../d6/d98/nmr_s_v_d_8h.html#a52115d0e7a485c4494aa20f4f3f4ebe7">nmrSVD</a> for further details.</p>
<dl class="section note"><dt>Note</dt><dd>The PInverse functions make use of LAPACK routines. To activate this code, set the CISST_HAS_CISSTNETLIB flag to ON during the configuration of cisst with CMake.</dd>
<dd>
The general rule for numerical functions which depend on LAPACK is that column-major matrices should be used everywhere, and that all matrices should be compact.</dd>
<dd>
For the specific case of PInverse, a valid result is also obtained if all the matrices are stored in row-major order. This is an exeption to the general rule. However, mixed-order is not tolerated. </dd></dl>
</div></td></tr>
<tr class="memitem:a1f68847a352d1889c52da964d07c3944"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerType &gt; </td></tr>
<tr class="memitem:a1f68847a352d1889c52da964d07c3944"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/d55/nmr_p_inverse_8h.html#a1f68847a352d1889c52da964d07c3944">nmrPInverse</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerType, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d6/d1b/classnmr_p_inverse_dynamic_data.html">nmrPInverseDynamicData</a> &amp;data)  throw (std::runtime_error)</td></tr>
<tr class="separator:a1f68847a352d1889c52da964d07c3944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8af6b318d2368e302c7284a889ea3ca8"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypePInverse , class _vectorOwnerTypeWorkspace &gt; </td></tr>
<tr class="memitem:a8af6b318d2368e302c7284a889ea3ca8"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/d55/nmr_p_inverse_8h.html#a8af6b318d2368e302c7284a889ea3ca8">nmrPInverse</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypePInverse, CISSTNETLIB_DOUBLE &gt; &amp;PInverse, <a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeWorkspace, CISSTNETLIB_DOUBLE &gt; &amp;Workspace)</td></tr>
<tr class="separator:a8af6b318d2368e302c7284a889ea3ca8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab79b0c76b7dbbd1b122f7b16fcd8d4f4"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypePInverse &gt; </td></tr>
<tr class="memitem:ab79b0c76b7dbbd1b122f7b16fcd8d4f4"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/d55/nmr_p_inverse_8h.html#ab79b0c76b7dbbd1b122f7b16fcd8d4f4">nmrPInverse</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypePInverse, CISSTNETLIB_DOUBLE &gt; &amp;PInverse)</td></tr>
<tr class="separator:ab79b0c76b7dbbd1b122f7b16fcd8d4f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa15e445e98843c37a5c4cba05e8749b"><td class="memTemplParams" colspan="2">template&lt;vct::size_type _rows, vct::size_type _cols, vct::size_type _work, bool _storageOrder, class _dataPtrType &gt; </td></tr>
<tr class="memitem:afa15e445e98843c37a5c4cba05e8749b"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/d55/nmr_p_inverse_8h.html#afa15e445e98843c37a5c4cba05e8749b">nmrPInverse</a> (<a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _rows, _cols, _storageOrder &gt; &amp;A, <a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _cols, _rows, _storageOrder &gt; &amp;pInverse, <a class="el" href="../../dc/d4e/classvct_fixed_size_vector_base.html">vctFixedSizeVectorBase</a>&lt; _work, 1, CISSTNETLIB_DOUBLE, _dataPtrType &gt; &amp;workspace)</td></tr>
<tr class="separator:afa15e445e98843c37a5c4cba05e8749b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210ef8ec3c6b5fd2c774ec67af6c3949"><td class="memTemplParams" colspan="2">template&lt;vct::size_type _rows, vct::size_type _cols, bool _storageOrder&gt; </td></tr>
<tr class="memitem:a210ef8ec3c6b5fd2c774ec67af6c3949"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/d55/nmr_p_inverse_8h.html#a210ef8ec3c6b5fd2c774ec67af6c3949">nmrPInverse</a> (<a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _rows, _cols, _storageOrder &gt; &amp;A, <a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _cols, _rows, _storageOrder &gt; &amp;pInverse)</td></tr>
<tr class="separator:a210ef8ec3c6b5fd2c774ec67af6c3949"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0694f8540c064c2aa6d8dbe488238462"><td class="memTemplParams" colspan="2">template&lt;vct::size_type _rows, vct::size_type _cols, bool _storageOrder&gt; </td></tr>
<tr class="memitem:a0694f8540c064c2aa6d8dbe488238462"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../dc/d55/nmr_p_inverse_8h.html#a0694f8540c064c2aa6d8dbe488238462">nmrPInverse</a> (<a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _rows, _cols, _storageOrder &gt; &amp;A, <a class="el" href="../../d1/d9f/classnmr_p_inverse_fixed_size_data.html">nmrPInverseFixedSizeData</a>&lt; _rows, _cols, _storageOrder &gt; &amp;data)</td></tr>
<tr class="separator:a0694f8540c064c2aa6d8dbe488238462"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declaration of nmrPInverse. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a1f68847a352d1889c52da964d07c3944"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrPInverse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerType, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d1b/classnmr_p_inverse_dynamic_data.html">nmrPInverseDynamicData</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2">std::runtime_error</td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function checks for valid input and calls the LAPACK function. The approach behind this defintion of the function is that the user creates a data object from a code wherein it is safe to do memory allocation. This data object is then passed on to this method along with the matrix whose PInverse is to be computed. The data object has members S, U, Vt and PInverse, which can be accessed through calls to method get*() along with adequate workspace for LAPACK. This function modifies the contents of matrix A. For details about nature of the data matrices see text above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>A matrix of size MxN, of one of <a class="el" href="../../dd/d81/classvct_dynamic_matrix.html" title="A matrix object of dynamic size. ">vctDynamicMatrix</a> or <a class="el" href="../../d6/dbd/classvct_dynamic_matrix_ref.html" title="Dynamic matrix referencing existing memory. ">vctDynamicMatrixRef</a> </td></tr>
    <tr><td class="paramname">data</td><td>A data object of one of the types corresponding to input matrix</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000009">Test:</a></b></dt><dd>nmrPInverseTest::TestDynamicColumnMajor nmrPInverseTest::TestDynamicRowMajor nmrPInverseTest::TestDynamicColumnMajorUserAlloc nmrPInverseTest::TestDynamicRowMajorUserAlloc </dd></dl>

</div>
</div>
<a class="anchor" id="a8af6b318d2368e302c7284a889ea3ca8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypePInverse , class _vectorOwnerTypeWorkspace &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrPInverse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypePInverse, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>PInverse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeWorkspace, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>Workspace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Basic version of PInverse where user provides the input matrix as well as storage for output and workspace needed by LAPACK. No mem allocation is done in this function, user allocates everything inlcuding workspace. The PInverse method verifies that the size of the data objects matchesc the input. See static methods in <a class="el" href="../../d6/d1b/classnmr_p_inverse_dynamic_data.html">nmrPInverseDynamicData</a> for helper functions that help determine the min workspace required. This function modifies the contents of matrix A. For sizes of other matrices see text above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>is a reference to a dynamic matrix of size MxN </td></tr>
    <tr><td class="paramname">PInverse</td><td>The output matrix for PInverse </td></tr>
    <tr><td class="paramname">Workspace</td><td>The workspace for LAPACK.</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000010">Test:</a></b></dt><dd>nmrPInverseTest::TestDynamicColumnMajorUserAlloc nmrPInverseTest::TestDynamicRowMajorUserAlloc </dd></dl>

</div>
</div>
<a class="anchor" id="ab79b0c76b7dbbd1b122f7b16fcd8d4f4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypePInverse &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrPInverse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypePInverse, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>PInverse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Basic version of PInverse where user provides the input matrix as well as storage for output. The PInverse method verifies that the size of the data objects matches the input and allocates workspace memory, which is deallocated when the function ends. This function modifies the contents of matrix A. For sizes of other matrices see text above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>is a reference to a dynamic matrix of size MxN </td></tr>
    <tr><td class="paramname">PInverse</td><td>The output matrices and vector for PInverse</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000011">Test:</a></b></dt><dd>nmrPInverseTest::TestDynamicColumnMajorUserAlloc nmrPInverseTest::TestDynamicRowMajorUserAlloc </dd></dl>

</div>
</div>
<a class="anchor" id="afa15e445e98843c37a5c4cba05e8749b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;vct::size_type _rows, vct::size_type _cols, vct::size_type _work, bool _storageOrder, class _dataPtrType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrPInverse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _rows, _cols, _storageOrder &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _cols, _rows, _storageOrder &gt; &amp;&#160;</td>
          <td class="paramname"><em>pInverse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d4e/classvct_fixed_size_vector_base.html">vctFixedSizeVectorBase</a>&lt; _work, 1, CISSTNETLIB_DOUBLE, _dataPtrType &gt; &amp;&#160;</td>
          <td class="paramname"><em>workspace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Basic version of pseudo inverse where user provides the input matrix as well as storage for output and workspace needed by LAPACK. No memory allocation is done in this function, user allocates everything including workspace. The nmrPInverse function verifies that the size of the S and workspace vector objects match the input. This function modifies the contents of matrix A. For sizes of other matrices see text above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Fixed size matrix of size MxN </td></tr>
    <tr><td class="paramname">pInverse</td><td>The output matrix for pseudo inverse </td></tr>
    <tr><td class="paramname">workspace</td><td>The workspace for LAPACK.</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000012">Test:</a></b></dt><dd>nmrPInverseTest::TestFixedSizeColumnMajorMLeqN_T2 nmrPInverseTest::TestFixedSizeRowMajorMLeqN_T2 nmrPInverseTest::TestFixedSizeColumnMajorMGeqN_T2 nmrPInverseTest::TestFixedSizeRowMajorMGeqN_T2 </dd></dl>

</div>
</div>
<a class="anchor" id="a210ef8ec3c6b5fd2c774ec67af6c3949"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;vct::size_type _rows, vct::size_type _cols, bool _storageOrder&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrPInverse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _rows, _cols, _storageOrder &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _cols, _rows, _storageOrder &gt; &amp;&#160;</td>
          <td class="paramname"><em>pInverse</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Basic version of pseudo-inverse where user provides the input matrix as well as storage for output. The nmrPInverse function verifies that the size of the S vector object matches the input and allocates workspace memory, which is deallocated when the function ends. This function modifies the contents of matrix A. For sizes of other matrices see text above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>Fixed size matrix of size MxN </td></tr>
    <tr><td class="paramname">pInverse</td><td>The output matrix for pseudo inverse</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000013">Test:</a></b></dt><dd>nmrPInverseTest::TestFixedSizeColumnMajorMLeqN_T2 nmrPInverseTest::TestFixedSizeRowMajorMLeqN_T2 nmrPInverseTest::TestFixedSizeColumnMajorMGeqN_T2 nmrPInverseTest::TestFixedSizeRowMajorMGeqN_T2 </dd></dl>

</div>
</div>
<a class="anchor" id="a0694f8540c064c2aa6d8dbe488238462"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;vct::size_type _rows, vct::size_type _cols, bool _storageOrder&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrPInverse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d1e/classvct_fixed_size_matrix.html">vctFixedSizeMatrix</a>&lt; CISSTNETLIB_DOUBLE, _rows, _cols, _storageOrder &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d1/d9f/classnmr_p_inverse_fixed_size_data.html">nmrPInverseFixedSizeData</a>&lt; _rows, _cols, _storageOrder &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Specialized version of pseudo-inverse for Fixed Size Matrix. since all error checking is done at compile time. The approach behind this defintion of the function is that the user creates a data object from a code wherein it is safe to do memory allocation. This data object is then passed on to this method along with the matrix whose SVD is to be computed. The data object has members S, U, and Vt, which can be accessed through calls to method get*() along with adequate workspace for LAPACK. This function modifies the contents of matrix A. For details about nature of the data matrices see text above.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>A matrix of size MxN </td></tr>
    <tr><td class="paramname">data</td><td>A data object of one of the types corresponding to input matrix</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000014">Test:</a></b></dt><dd>nmrPInverseTest::TestFixedSizeColumnMajorMLeqN nmrPInverseTest::TestFixedSizeRowMajorMLeqN nmrPInverseTest::TestFixedSizeColumnMajorMGeqN nmrPInverseTest::TestFixedSizeRowMajorMGeqN </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
