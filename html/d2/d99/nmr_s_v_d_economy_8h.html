<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>cisst-saw: /Users/anton/devel/cisst-saw/cisst/cisstNumerical/nmrSVDEconomy.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">cisst-saw
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_bdff4d348099aa104eae1764e6054132.html">cisst</a></li><li class="navelem"><a class="el" href="../../dir_3a66d2682027fbba9722fbcbf83c04c4.html">cisstNumerical</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">nmrSVDEconomy.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Declaration of nmrSVDEconomy.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="../../da/d57/cmn_throw_8h_source.html">cisstCommon/cmnThrow.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d2/d24/vct_fixed_size_matrix_8h_source.html">cisstVector/vctFixedSizeMatrix.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d3/d31/vct_dynamic_matrix_8h_source.html">cisstVector/vctDynamicMatrix.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../d7/d65/nmr_netlib_8h_source.html">cisstNumerical/nmrNetlib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="../../de/da9/nmr_export_8h_source.html">cisstNumerical/nmrExport.h</a>&gt;</code><br />
</div>
<p><a href="../../d2/d99/nmr_s_v_d_economy_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html">nmrSVDEconomyDynamicData</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data for SVD problem (Dynamic).  <a href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/classnmr_s_v_d_economy_dynamic_data_1_1_friend.html">nmrSVDEconomyDynamicData::Friend</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td colspan="2"><div class="groupHeader">Algorithm SVD: Singular Value Decomposition</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>The <a class="el" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a7a5496ff2d20946e8738baac82318603">nmrSVDEconomy</a> functions compute the singular value decomposition (SVD) of a real <img class="formulaInl" alt="$ M \times N $" src="../../form_152.png"/> matrix A, optionally computing the left and/or right singular vectors. The SVD problem is written:</p>
<p><img class="formulaInl" alt="$ A = U * \Sigma * V^{T} $" src="../../form_218.png"/></p>
<p>where <img class="formulaInl" alt="$ \Sigma $" src="../../form_219.png"/> is a <img class="formulaInl" alt="$ M \times N $" src="../../form_152.png"/> matrix which is zero except for its min(m,n) diagonal elements, U is a <img class="formulaInl" alt="$ M \times M $" src="../../form_147.png"/> orthogonal matrix, and V is a <img class="formulaInl" alt="$ N \times N $" src="../../form_151.png"/> orthogonal matrix. The diagonal elements of <img class="formulaInl" alt="$ \Sigma $" src="../../form_219.png"/> are the singular values of A; they are real and non-negative, and are returned in descending order. The first <img class="formulaInl" alt="$ \mbox{min}(m,n) $" src="../../form_210.png"/> columns of U and V are the left and right singular vectors of A.</p>
<p>These functions are wrappers around the LAPACK routine dgesvd, therefore they share some features with the LAPACK routine: </p><ol>
<li>
They return <img class="formulaInl" alt="$ V^{T} $" src="../../form_202.png"/>, not <img class="formulaInl" alt="$ V $" src="../../form_203.png"/>. </li>
<li>
On exit, the content of A is altered. </li>
<li>
The vectors and matrices must be compact, i.e. use a contiguous block of memory. </li>
</ol>
<p>The <a class="el" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a7a5496ff2d20946e8738baac82318603">nmrSVDEconomy</a> functions add the following features: </p><ol>
<li>
A simplified interface to the cisstVector matrices, either <a class="el" href="../../dd/d81/classvct_dynamic_matrix.html" title="A matrix object of dynamic size. ">vctDynamicMatrix</a> </li>
<li>
The possibility to use any storage order, i.e. <a class="el" href="../../d8/d36/vct_forward_declarations_8h.html#a45ba752f741240bf765417ebc8130d62">VCT_ROW_MAJOR</a> or <a class="el" href="../../d8/d36/vct_forward_declarations_8h.html#a432cdf8923afaf82f551450ad4034746">VCT_COL_MAJOR</a>. In the specific case of SVD, the storage order can be treated as a transpose and the properties of the decomposition are preserved (<a class="el" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a7a5496ff2d20946e8738baac82318603">nmrSVDEconomy</a> will swap U and Vt pointers). This is performed at no extra cost, i.e. no copy back and forth of the elements nor extra memory allocation. </li>
<li>
Input validation checks are performed, i.e. an std::runtime_error exception will be thrown if the sizes or storage order don't match or if the containers are not compact. </li>
<li>
Helper classes to allocate memory for the output and workspace: <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html" title="Data for SVD problem (Dynamic). ">nmrSVDEconomyDynamicData</a>. </li>
</ol>
<p>There are different ways to call this function to compute the SVD of the matrix A. These correspond to different overloaded <a class="el" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a7a5496ff2d20946e8738baac82318603">nmrSVDEconomy</a> functions: </p><ol>
<li>
<p class="startli">Using a preallocated data object.</p>
<p>The user creates the input matrix A: </p><div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(12, 24 , <a class="code" href="../../d8/d36/vct_forward_declarations_8h.html#a45ba752f741240bf765417ebc8130d62">VCT_ROW_MAJOR</a>); <span class="comment">// 12 x 24 matrix</span></div>
<div class="line"><a class="code" href="../../dc/d50/group__cisst_vector.html#ga0d25660a2dc6ef9c093f6f6b2804d2d0">vctRandom</a>(A, -10.0, 10.0);</div>
</div><!-- fragment --><p> The user allocates a data object which could be of type <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html" title="Data for SVD problem (Dynamic). ">nmrSVDEconomyDynamicData</a>. corresponding to fixed size or dynamic matrix A: </p><div class="fragment"><div class="line"><a class="code" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html">nmrSVDEconomyDynamicData</a> data(A);</div>
</div><!-- fragment --><p> Call the nmrSVDEconomy function: </p><div class="fragment"><div class="line"><a class="code" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a85e9553899a9c16f62ea1b18e01c5263">nmrSVDEconomy</a>(A, data);</div>
</div><!-- fragment --><p> The content of input matrix A is modified by this routine. The matrices U, Vt and vector S are available through the following methods </p><div class="fragment"><div class="line">std::cout &lt;&lt; <span class="stringliteral">&quot;U: &quot;</span> &lt;&lt; data.U() &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;S: &quot;</span> &lt;&lt; data.S() &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;V: &quot;</span> &lt;&lt; data.Vt().Transpose() &lt;&lt; std::endl;</div>
</div><!-- fragment --><p class="endli"></p>
</li>
<li>
<p class="startli">The user provides the matrices U, Vt, and vector S.</p>
<p>The User allocates memory for these matrices and vector: </p><div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(5, 4);</div>
<div class="line"><a class="code" href="../../dc/d50/group__cisst_vector.html#ga0d25660a2dc6ef9c093f6f6b2804d2d0">vctRandom</a>(A, -10.0, 10.0);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> U(5, 5);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> Vt(4, 4);</div>
<div class="line"><a class="code" href="../../d8/d36/classvct_dynamic_vector.html">vctDynamicVector&lt;CISSTNETLIB_DOUBLE&gt;</a> S(4);</div>
</div><!-- fragment --><p> Call the SVD routine: </p><div class="fragment"><div class="line"><a class="code" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a85e9553899a9c16f62ea1b18e01c5263">nmrSVDEconomy</a>(A, U, S, Vt);</div>
</div><!-- fragment --><p> The SVD function verifies that the size of the data objects matches the input, and allocates workspace memory, which is deallocated when the function ends.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The user provides the matrices U, Vt, and vector S along with workspace required by SVD routine of LAPACK.</p>
<p>Create matrices and vector: </p><div class="fragment"><div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> A(5, 4);</div>
<div class="line"><a class="code" href="../../dc/d50/group__cisst_vector.html#ga0d25660a2dc6ef9c093f6f6b2804d2d0">vctRandom</a>(A, -10.0, 10.0);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> U(5, 5);</div>
<div class="line"><a class="code" href="../../dd/d81/classvct_dynamic_matrix.html">vctDynamicMatrix&lt;CISSTNETLIB_DOUBLE&gt;</a> Vt(4, 4);</div>
<div class="line"><a class="code" href="../../d8/d36/classvct_dynamic_vector.html">vctDynamicVector&lt;CISSTNETLIB_DOUBLE&gt;</a> S(4);</div>
</div><!-- fragment --><p> One also needs to allocate memory the for workspace. This approach is particularly useful when the user is using more than one numerical method from the library and is willing or need to share the workspace between them. In such as case, the user can allocate a block of memory greater than the minimum required by different methods. To help the user determine the minimum workspace required the library provides the helper function <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#a32eab3e8694ef5e6db13ea76f7ba1460">nmrSVDEconomyDynamicData::WorkspaceSize()</a>. </p><div class="fragment"><div class="line"><a class="code" href="../../d8/d36/classvct_dynamic_vector.html">vctDynamicVector&lt;CISSTNETLIB_DOUBLE&gt;</a> workspace(<a class="code" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#a32eab3e8694ef5e6db13ea76f7ba1460">nmrSVDEconomyDynamicData::WorkspaceSize</a>(A));</div>
</div><!-- fragment --><p> Call the SVD function: </p><div class="fragment"><div class="line"><a class="code" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a85e9553899a9c16f62ea1b18e01c5263">nmrSVDEconomy</a>(A, U, S, Vt, workspace);</div>
</div><!-- fragment --><p class="endli"></p>
</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>The SVD functions make use of LAPACK routines. To activate this code, set the CISST_HAS_CISSTNETLIB flag to ON during the configuration of cisst with CMake.</dd>
<dd>
The general rule for numerical functions which depend on LAPACK is that column major matrices should be used everywhere, and that all matrices should be compact. In this case, both row major and column major are allowed but they must not be mixed in a data object. </dd></dl>
</div></td></tr>
<tr class="memitem:a85e9553899a9c16f62ea1b18e01c5263"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerType &gt; </td></tr>
<tr class="memitem:a85e9553899a9c16f62ea1b18e01c5263"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a85e9553899a9c16f62ea1b18e01c5263">nmrSVDEconomy</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerType, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html">nmrSVDEconomyDynamicData</a> &amp;data)  throw (std::runtime_error)</td></tr>
<tr class="separator:a85e9553899a9c16f62ea1b18e01c5263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a838d5cc272226fda8e2aed9830f405e3"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt , class _vectorOwnerTypeWorkspace &gt; </td></tr>
<tr class="memitem:a838d5cc272226fda8e2aed9830f405e3"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a838d5cc272226fda8e2aed9830f405e3">nmrSVDEconomy</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;U, <a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;S, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;Vt, <a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeWorkspace, CISSTNETLIB_DOUBLE &gt; &amp;Workspace)</td></tr>
<tr class="separator:a838d5cc272226fda8e2aed9830f405e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a5496ff2d20946e8738baac82318603"><td class="memTemplParams" colspan="2">template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt &gt; </td></tr>
<tr class="memitem:a7a5496ff2d20946e8738baac82318603"><td class="memTemplItemLeft" align="right" valign="top">CISSTNETLIB_INTEGER&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d2/d99/nmr_s_v_d_economy_8h.html#a7a5496ff2d20946e8738baac82318603">nmrSVDEconomy</a> (<a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;A, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;U, <a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;S, <a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;Vt)</td></tr>
<tr class="separator:a7a5496ff2d20946e8738baac82318603"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Declaration of nmrSVDEconomy. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a85e9553899a9c16f62ea1b18e01c5263"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrSVDEconomy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerType, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html">nmrSVDEconomyDynamicData</a> &amp;&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
        <tr>
          <td align="right">throw </td><td>(</td><td colspan="2">std::runtime_error</td>
        </tr>
        <tr>
          <td align="right"></td><td>)</td><td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves the SVD problem for a dynamic matrix using an <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html" title="Data for SVD problem (Dynamic). ">nmrSVDEconomyDynamicData</a>.</p>
<p>This function checks for valid input (size, storage order and compact) and calls the LAPACK function. If the input doesn't match the data, an exception is thrown (<code>std::runtime_error</code>).</p>
<p>This function modifies the input matrix A and stores the results in the data. Each component of the result can be obtained via the const methods <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#a9e9211a54443d529c82a2c1f8161934f">nmrSVDEconomyDynamicData::U()</a>, <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#a5326180f759203b44165d655dd9c7cc3">nmrSVDEconomyDynamicData::S()</a> and <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#a191e18293e746bb00deec285c1bb39f8">nmrSVDEconomyDynamicData::Vt()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>A matrix of size MxN, either <a class="el" href="../../dd/d81/classvct_dynamic_matrix.html" title="A matrix object of dynamic size. ">vctDynamicMatrix</a> or <a class="el" href="../../d6/dbd/classvct_dynamic_matrix_ref.html" title="Dynamic matrix referencing existing memory. ">vctDynamicMatrixRef</a>. </td></tr>
    <tr><td class="paramname">data</td><td>A data object corresponding to the input matrix.</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000027">Test:</a></b></dt><dd>nmrSVDEconomyTest::TestDynamicColumnMajor nmrSVDEconomyTest::TestDynamicRowMajor nmrSVDEconomyTest::TestDynamicColumnMajorUserAlloc nmrSVDEconomyTest::TestDynamicRowMajorUserAlloc </dd></dl>

</div>
</div>
<a class="anchor" id="a838d5cc272226fda8e2aed9830f405e3"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt , class _vectorOwnerTypeWorkspace &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrSVDEconomy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>Vt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeWorkspace, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>Workspace</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves the SVD problem for a dynamic matrix using the storage provided by the user for both the output (U, S, Vt) and the workspace.</p>
<p>Internally, a data is created using the storage provided by the user (see <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#a6a565c76dcc2d1b5440d8deff372d2bc">nmrSVDEconomyDynamicData::SetRef</a>). While the data is being build, the consistency of the output and workspace is checked. Then, the nmrSVDEconomy(A, data) function can be used safely.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>is a reference to a dynamic matrix of size MxN </td></tr>
    <tr><td class="paramname">U,S,Vt</td><td>The output matrices and vector for SVD </td></tr>
    <tr><td class="paramname">Workspace</td><td>The workspace for LAPACK.</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000028">Test:</a></b></dt><dd>nmrSVDEconomyTest::TestDynamicColumnMajorUserAlloc nmrSVDEconomyTest::TestDynamicRowMajorUserAlloc </dd></dl>

</div>
</div>
<a class="anchor" id="a7a5496ff2d20946e8738baac82318603"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class _matrixOwnerTypeA , class _matrixOwnerTypeU , class _vectorOwnerTypeS , class _matrixOwnerTypeVt &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CISSTNETLIB_INTEGER nmrSVDEconomy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeA, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeU, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/dc5/classvct_dynamic_vector_base.html">vctDynamicVectorBase</a>&lt; _vectorOwnerTypeS, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>S</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/d56/classvct_dynamic_matrix_base.html">vctDynamicMatrixBase</a>&lt; _matrixOwnerTypeVt, CISSTNETLIB_DOUBLE &gt; &amp;&#160;</td>
          <td class="paramname"><em>Vt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This function solves the SVD problem for a dynamic matrix using the storage provided by the user for the output (U, S, Vt). A workspace will be dynamically allocated.</p>
<p>Internally, a data is created using the storage provided by the user (see <a class="el" href="../../da/d4a/classnmr_s_v_d_economy_dynamic_data.html#a006e07c4a0b8c0dcd2c1ab85d588a139">nmrSVDEconomyDynamicData::SetRefOutput</a>). While the data is being build, the consistency of the output is checked. Then, the nmrSVDEconomy(A, data) function can be used safely.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">A</td><td>is a reference to a dynamic matrix of size MxN </td></tr>
    <tr><td class="paramname">U,S,Vt</td><td>The output matrices and vector for SVD</td></tr>
  </table>
  </dd>
</dl>
<dl class="test"><dt><b><a class="el" href="../../d4/df6/test.html#_test000029">Test:</a></b></dt><dd>nmrSVDEconomyTest::TestDynamicColumnMajorUserAlloc nmrSVDEconomyTest::TestDynamicRowMajorUserAlloc</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Again, this method will dynamically allocate a workspace at each call. This is somewhat inefficient if the method is to be called many times. For a real-time task, the dynamic allocation might even break your application. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
